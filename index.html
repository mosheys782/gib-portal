<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GIB Portal</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--white:#fff;--off-white:#f7f8fc;--g50:#f0f2f7;--g100:#e4e7ef;--g200:#cdd2de;--g400:#8e96a8;--g500:#6b7489;--g600:#4a5268;--g800:#1e2538;--g900:#0f1520;--navy:#1a2d52;--navyd:#152342;--blue:#3b6cb5;--mw:1200px}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Outfit',-apple-system,BlinkMacSystemFont,sans-serif;background:var(--off-white);color:var(--g800);-webkit-font-smoothing:antialiased}
.ctr{max-width:var(--mw);margin:0 auto;padding:0 32px}
.topbar-w{background:var(--navyd)}
.topbar{max-width:var(--mw);margin:0 auto;padding:0 32px;height:64px;display:flex;align-items:center;justify-content:space-between}
.tb-l{display:flex;align-items:center;gap:20px}
.tb-logo{height:44px}
.tb-r{display:flex;align-items:center;gap:14px}
.tb-date{font-size:13px;color:rgba(255,255,255,.85)}
.admin-btn{background:none;border:none;color:rgba(255,255,255,.85);cursor:pointer;font-size:20px;padding:4px 8px;border-radius:6px;transition:all .15s;line-height:1}
.admin-btn:hover{color:#fff;background:rgba(255,255,255,.12)}
.snav-w{background:var(--white);border-bottom:1px solid var(--g100)}
.snav{max-width:var(--mw);margin:0 auto;padding:0 32px;display:flex;gap:4px;height:48px;align-items:center}
.snav a{display:flex;align-items:center;gap:8px;padding:8px 16px;border-radius:8px;color:var(--g500);text-decoration:none;font-size:14px;font-weight:500;transition:all .15s;cursor:pointer}
.snav a:hover{background:var(--g50);color:var(--g800)}
.snav a.active{background:#e8f0fd;color:var(--blue);font-weight:600}
.welcome-bar{text-align:center;padding:36px 0 4px;font-size:24px;font-weight:300;color:var(--g800)}
.welcome-bar span{color:var(--blue);font-weight:500}
.content{padding:32px 0}
.sec-label{font-size:12px;font-weight:600;letter-spacing:1.5px;text-transform:uppercase;color:var(--g400);margin-bottom:20px}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
.card{background:var(--white);border:1px solid var(--g100);border-radius:14px;padding:24px;display:flex;flex-direction:column;text-decoration:none;color:inherit;transition:all .2s;box-shadow:0 1px 3px rgba(15,21,32,.04)}
.card:hover{transform:translateY(-3px);box-shadow:0 12px 40px rgba(15,21,32,.08);border-color:var(--g200)}
.card-icon{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;margin-bottom:16px;font-size:22px}
.card-name{font-size:16px;font-weight:600;color:var(--g900);margin-bottom:6px}
.card-desc{font-size:13px;color:var(--g500);line-height:1.5;flex:1;margin-bottom:16px}
.card-foot{display:flex;align-items:center;justify-content:space-between;padding-top:14px;border-top:1px solid var(--g50)}
.card-url{font-size:12px;color:var(--g400)}
.card-go{width:32px;height:32px;border-radius:50%;background:var(--g50);display:flex;align-items:center;justify-content:center;font-size:14px;color:var(--g500);transition:all .15s}
.card:hover .card-go{background:var(--blue);color:#fff}
.foot-w{border-top:1px solid var(--g100);margin-top:20px}
.foot{max-width:var(--mw);margin:0 auto;padding:24px 32px;display:flex;justify-content:space-between;font-size:12px;color:var(--g400)}
.auth{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:28px;background:linear-gradient(165deg,#f7f8fc 0%,#e8f0fd 50%,#f0f2f7 100%)}
.auth-logo{height:72px}
.auth-spin{width:36px;height:36px;border:3px solid var(--g200);border-top-color:var(--blue);border-radius:50%;animation:sp .7s linear infinite}
@keyframes sp{to{transform:rotate(360deg)}}
.auth-st{font-size:14px;color:var(--g500)}
.auth-btn{padding:12px 32px;border-radius:10px;border:none;background:var(--blue);color:#fff;font-family:inherit;font-size:15px;font-weight:500;cursor:pointer;display:none}
.auth-btn:hover{background:#2d5a9e}
.mo{display:none;position:fixed;inset:0;background:rgba(0,0,0,.4);z-index:100;align-items:center;justify-content:center}
.mo.open{display:flex}
.modal{background:var(--white);border-radius:16px;width:700px;max-width:95vw;max-height:85vh;overflow-y:auto;box-shadow:0 20px 60px rgba(15,21,32,.1)}
.mh{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid var(--g100)}
.mh h2{font-size:18px;font-weight:600}
.mx{background:none;border:none;font-size:22px;cursor:pointer;color:var(--g400);padding:4px 8px}
.mx:hover{color:var(--g800)}
.mb{padding:20px 24px}
.mtabs{display:flex;gap:4px;margin-bottom:20px}
.mtab{padding:8px 16px;border-radius:8px;border:none;background:var(--g50);color:var(--g600);font-family:inherit;font-size:13px;font-weight:500;cursor:pointer}
.mtab.active{background:var(--blue);color:#fff}
.ai{display:flex;align-items:center;gap:12px;padding:12px;border:1px solid var(--g100);border-radius:10px;margin-bottom:8px}
.ai .ii{font-size:22px;width:36px;text-align:center}
.ai .info{flex:1}
.ai .nm{font-size:14px;font-weight:600}
.ai .ur{font-size:12px;color:var(--g400)}
.ai button{background:none;border:none;cursor:pointer;font-size:16px;padding:4px 8px;border-radius:6px}
.ai .be{color:var(--blue)}.ai .be:hover{background:#e8f0fd}
.ai .bd{color:#d44}.ai .bd:hover{background:#fee}
.ai .bm{color:var(--g400)}.ai .bm:hover{background:var(--g50)}
.aa{display:flex;align-items:center;justify-content:center;gap:8px;padding:12px;border:2px dashed var(--g200);border-radius:10px;color:var(--g400);font-size:13px;font-weight:500;cursor:pointer;transition:all .15s}
.aa:hover{border-color:var(--blue);color:var(--blue)}
.ef{padding:16px;background:var(--g50);border-radius:10px;margin-bottom:12px}
.ef label{display:block;font-size:12px;font-weight:600;color:var(--g600);margin-bottom:4px;margin-top:10px}
.ef label:first-child{margin-top:0}
.ef input,.ef textarea{width:100%;padding:8px 12px;border:1px solid var(--g200);border-radius:8px;font-family:inherit;font-size:13px}
.ef .fa{display:flex;gap:8px;margin-top:14px}
.ef .bs{padding:8px 20px;border-radius:8px;border:none;background:var(--blue);color:#fff;font-family:inherit;font-size:13px;font-weight:500;cursor:pointer}
.ef .bc{padding:8px 20px;border-radius:8px;border:1px solid var(--g200);background:var(--white);color:var(--g600);font-family:inherit;font-size:13px;cursor:pointer}
@media(max-width:900px){.grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.grid{grid-template-columns:1fr}.ctr,.topbar,.snav,.foot{padding-left:16px;padding-right:16px}}
</style>
</head>
<body>
<div id="authScreen" class="auth">
  <img src="data:image/png;base64,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" class="auth-logo" alt="GIB">
  <div class="auth-spin" id="authSpinner"></div>
  <div class="auth-st" id="authStatus">Signing in...</div>
  <button class="auth-btn" id="authBtn" onclick="doLogin()">Sign in with Microsoft</button>
</div>
<div id="portal" style="display:none">
  <div class="topbar-w"><div class="topbar">
    <div class="tb-l">
      <img src="data:image/png;base64,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" class="tb-logo" alt="GIB">
    </div>
    <div class="tb-r">
      <div class="tb-date" id="topDate"></div>
      <button class="admin-btn" id="adminBtn" onclick="openAdmin()" title="Manage links" style="display:none">&#9881;</button>
    </div>
  </div></div>
  <div class="snav-w"><div class="snav" id="subnav">
    <a class="active" data-section="applications" onclick="switchSection('applications')"><span>&#128203;</span><span>Applications</span></a>
    <a data-section="carriers" onclick="switchSection('carriers')"><span>&#127970;</span><span>Carriers &amp; Vendors</span></a>
    <a data-section="tools" onclick="switchSection('tools')"><span>&#128736;&#65039;</span><span>Tools</span></a>
  </div></div>
  <div class="ctr">
    <div class="welcome-bar" id="greeting"></div>
    <div class="content">
      <div id="secApps"><div class="sec-label">Applications</div><div class="grid" id="appsGrid"></div></div>
      <div id="secCarr" style="display:none"><div class="sec-label">Carriers &amp; Vendors</div><div class="grid" id="carrGrid"></div></div>
      <div id="secTools" style="display:none"><div class="sec-label">Tools</div><div class="grid" id="toolsGrid"></div></div>
    </div>
  </div>
  <div class="foot-w"><div class="foot">
    <span>&copy; 2025 Gancfried Insurance Brokerage</span>
    <span id="footDate"></span>
  </div></div>
</div>
<div class="mo" id="adminModal">
  <div class="modal">
    <div class="mh"><h2>Manage Links</h2><button class="mx" onclick="closeAdmin()">&times;</button></div>
    <div class="mb">
      <div class="mtabs">
        <button class="mtab active" onclick="switchAdminTab('applications')">Applications</button>
        <button class="mtab" onclick="switchAdminTab('carriers')">Carriers &amp; Vendors</button>
        <button class="mtab" onclick="switchAdminTab('tools')">Tools</button>
        <button class="mtab" onclick="switchAdminTab('admins')">Admins</button>
      </div>
      <div id="adminList"></div>
      <div class="aa" onclick="addNewItem()">+ Add new link</div>
    </div>
  </div>
</div>
<script src="https://alcdn.msauth.net/browser/2.38.0/js/msal-browser.min.js"></script>
<script>
var ADMIN_EMAILS = ['moshe@gibusa.com','mgancfried@gibusa.com'];

var DEFAULT_APPS = [
  {name:'Licenses',desc:'License management system',url:'https://apps.powerapps.com',icon:'\ud83d\udccb',iconBg:'#e6f7ef'},
  {name:'Policy Management',desc:'Policy administration portal',url:'https://apps.powerapps.com',icon:'\ud83d\udee1\ufe0f',iconBg:'#e8f0fd'},
  {name:'OpsPay',desc:'Payment operations dashboard',url:'https://opspay.gibusa.com',icon:'\ud83d\udcb0',iconBg:'#eeebfc'},
  {name:'SharePoint',desc:'Document management',url:'https://gibusa.sharepoint.com',icon:'\ud83d\udcc1',iconBg:'#e8f0fd'},
  {name:'Outlook',desc:'Email & calendar',url:'https://outlook.office.com',icon:'\u2709\ufe0f',iconBg:'#e6f7ef'},
  {name:'Teams',desc:'Chat & collaboration',url:'https://teams.microsoft.com',icon:'\ud83d\udcac',iconBg:'#eeebfc'}
];

var DEFAULT_CARRIERS = [
  {name:'Applied Epic',desc:'Agency management system',url:'https://epic.appliedsystems.com',icon:'\ud83d\udcca',iconBg:'#e8f0fd'},
  {name:'NYAIP',desc:'NY Auto Insurance Plan',url:'https://www.nyaip.org',icon:'\ud83d\ude97',iconBg:'#fef3e6'},
  {name:'Lancer',desc:'Insurance carrier portal',url:'https://www.lancerinsurance.com',icon:'\ud83d\udee1\ufe0f',iconBg:'#e6f7ef'},
  {name:'Progressive',desc:'Commercial lines portal',url:'https://www.foragentsonly.com',icon:'\ud83d\ude99',iconBg:'#e8f0fd'},
  {name:'EMPLOYERS',desc:'Workers compensation',url:'https://www.employers.com',icon:'\ud83c\udfe2',iconBg:'#eeebfc'},
  {name:'Pie Insurance',desc:'Workers comp solutions',url:'https://www.pieinsurance.com',icon:'\ud83e\udd67',iconBg:'#fef3e6'}
];

var DEFAULT_TOOLS = [
  {name:'AMS360',desc:'Agency management system',url:'https://www.vertafore.com',icon:'\ud83d\udcbb',iconBg:'#e8f0fd'},
  {name:'Carrier Connect',desc:'Carrier quoting portal',url:'https://www.ivans.com',icon:'\ud83d\udd17',iconBg:'#eeebfc'},
  {name:'ACORD Forms',desc:'Insurance forms library',url:'https://www.acord.org',icon:'\ud83d\udcc4',iconBg:'#e6f7ef'},
  {name:'Loss Runs',desc:'Loss run request tool',url:'https://www.fieldfirst.com',icon:'\ud83d\udcca',iconBg:'#fef3e6'},
  {name:'Certificate Manager',desc:'COI issuance & tracking',url:'https://certificates.gibusa.com',icon:'\ud83d\udcdc',iconBg:'#e8f0fd'},
  {name:'Rater',desc:'Comparative rating tool',url:'https://www.ezlynx.com',icon:'\ud83d\udcb2',iconBg:'#eeebfc'}
];

var msalApp, currentUser={}, isAdmin=false;
var currentSection='applications', currentAdminTab='applications';
var configData = null;
var GITHUB_REPO = 'mosheys782/gib-portal';
var CONFIG_PATH = 'config.json';

// Config loading - try config.json first, fall back to defaults
async function loadConfig() {
  try {
    var resp = await fetch('config.json?t=' + Date.now());
    if (resp.ok) {
      configData = await resp.json();
      console.log('Loaded config.json');
    }
  } catch(e) {
    console.log('No config.json, using defaults');
  }
}

function getItems(section) {
  if (configData && configData[section]) return configData[section];
  if (section === 'apps') return DEFAULT_APPS;
  if (section === 'carriers') return DEFAULT_CARRIERS;
  if (section === 'tools') return DEFAULT_TOOLS;
  return [];
}

function sectionKey(tab) {
  if (tab === 'applications') return 'apps';
  if (tab === 'carriers') return 'carriers';
  return 'tools';
}

function renderCards() {
  document.getElementById('appsGrid').innerHTML = getItems('apps').map(cardHTML).join('');
  document.getElementById('carrGrid').innerHTML = getItems('carriers').map(cardHTML).join('');
  document.getElementById('toolsGrid').innerHTML = getItems('tools').map(cardHTML).join('');
}

function cardHTML(item) {
  var domain = '';
  try { domain = new URL(item.url).hostname.replace('www.',''); } catch(e){}
  return '<a class="card" href="'+item.url+'" target="_blank" rel="noopener">'+
    '<div class="card-icon" style="background:'+item.iconBg+'">'+item.icon+'</div>'+
    '<div class="card-name">'+item.name+'</div>'+
    '<div class="card-desc">'+item.desc+'</div>'+
    '<div class="card-foot"><span class="card-url">'+domain+'</span><div class="card-go">\u2192</div></div></a>';
}

function switchSection(sec) {
  currentSection = sec;
  document.getElementById('secApps').style.display = sec==='applications'?'':'none';
  document.getElementById('secCarr').style.display = sec==='carriers'?'':'none';
  document.getElementById('secTools').style.display = sec==='tools'?'':'none';
  document.querySelectorAll('.snav a').forEach(function(l){ l.classList.toggle('active', l.getAttribute('data-section')===sec); });
}

// Admin
function openAdmin() { if(!isAdmin)return; document.getElementById('adminModal').classList.add('open'); renderAdminList(); }
function closeAdmin() { document.getElementById('adminModal').classList.remove('open'); }

function switchAdminTab(tab) {
  currentAdminTab = tab;
  document.querySelectorAll('.mtab').forEach(function(t,i){
    t.classList.toggle('active', (i===0 && tab==='applications') || (i===1 && tab==='carriers') || (i===2 && tab==='tools') || (i===3 && tab==='admins'));
  });
  renderAdminList();
}

function renderAdminList() {
  if (currentAdminTab === 'admins') { renderAdminEmails(); return; }
  var key = sectionKey(currentAdminTab);
  var items = getItems(key);
  var html = '';
  items.forEach(function(item, idx) {
    html += '<div class="ai"><div class="ii">'+item.icon+'</div><div class="info"><div class="nm">'+item.name+'</div><div class="ur">'+item.url+'</div></div>'+
      '<button class="bm" onclick="moveItem('+idx+',-1)" title="Move up">\u2191</button>'+
      '<button class="bm" onclick="moveItem('+idx+',1)" title="Move down">\u2193</button>'+
      '<button class="be" onclick="editItem('+idx+')" title="Edit">\u270e</button>'+
      '<button class="bd" onclick="deleteItem('+idx+')" title="Delete">\u2716</button></div>';
  });
  document.getElementById('adminList').innerHTML = html;
}

function getAdminEmails() {
  if (configData && configData.admins) return configData.admins;
  return ADMIN_EMAILS.slice();
}

function renderAdminEmails() {
  var emails = getAdminEmails();
  var html = '<div style="margin-bottom:12px;font-size:13px;color:var(--g500)">Users with admin access can manage all portal links.</div>';
  emails.forEach(function(email, idx) {
    html += '<div class="ai"><div class="ii">\ud83d\udc64</div><div class="info"><div class="nm">'+email+'</div></div>'+
      '<button class="bd" onclick="removeAdmin('+idx+')" title="Remove">\u2716</button></div>';
  });
  html += '<div style="display:flex;gap:8px;margin-top:12px"><input id="newAdminEmail" placeholder="email@gibusa.com" style="flex:1;padding:8px 12px;border:1px solid var(--g200);border-radius:8px;font-family:inherit;font-size:13px">'+
    '<button class="bs" style="padding:8px 20px;border-radius:8px;border:none;background:var(--blue);color:#fff;font-family:inherit;font-size:13px;font-weight:500;cursor:pointer" onclick="addAdmin()">Add</button></div>';
  document.getElementById('adminList').innerHTML = html;
}

function addAdmin() {
  var email = document.getElementById('newAdminEmail').value.trim().toLowerCase();
  if (!email || !email.includes('@')) { alert('Enter a valid email'); return; }
  var emails = getAdminEmails();
  if (emails.indexOf(email) !== -1) { alert('Already an admin'); return; }
  emails.push(email);
  if (!configData) configData = { apps: DEFAULT_APPS.slice(), carriers: DEFAULT_CARRIERS.slice(), tools: DEFAULT_TOOLS.slice() };
  configData.admins = emails;
  ADMIN_EMAILS = emails;
  saveConfigToGitHub();
  renderAdminEmails();
}

function removeAdmin(idx) {
  var emails = getAdminEmails();
  if (emails[idx].toLowerCase() === currentUser.email.toLowerCase()) { alert('Cannot remove yourself'); return; }
  if (!confirm('Remove ' + emails[idx] + ' from admins?')) return;
  emails.splice(idx, 1);
  if (!configData) configData = { apps: DEFAULT_APPS.slice(), carriers: DEFAULT_CARRIERS.slice(), tools: DEFAULT_TOOLS.slice() };
  configData.admins = emails;
  ADMIN_EMAILS = emails;
  saveConfigToGitHub();
  renderAdminEmails();
}

function editItem(idx) {
  var key = sectionKey(currentAdminTab);
  var items = getItems(key);
  var item = idx >= 0 ? items[idx] : {name:'',desc:'',url:'https://',icon:'\ud83d\udccc',iconBg:'#e8f0fd'};
  var html = '<div class="ef"><label>Name</label><input id="eName" value="'+item.name+'">'+
    '<label>URL</label><input id="eUrl" value="'+item.url+'">'+
    '<label>Description</label><input id="eDesc" value="'+item.desc+'">'+
    '<label>Icon (emoji)</label><input id="eIcon" value="'+item.icon+'" style="width:60px">'+
    '<label>Icon Background</label><input id="eIconBg" type="color" value="'+item.iconBg+'" style="width:60px;height:32px;padding:2px">'+
    '<div class="fa"><button class="bs" onclick="saveItem('+idx+')">Save</button><button class="bc" onclick="renderAdminList()">Cancel</button></div></div>';
  document.getElementById('adminList').innerHTML = html;
}

function saveItem(idx) {
  var key = sectionKey(currentAdminTab);
  var items = getItems(key).slice();
  var obj = {name:document.getElementById('eName').value, url:document.getElementById('eUrl').value, desc:document.getElementById('eDesc').value, icon:document.getElementById('eIcon').value, iconBg:document.getElementById('eIconBg').value};
  if (idx >= 0) { items[idx] = obj; } else { items.push(obj); }
  if (!configData) configData = { apps: DEFAULT_APPS.slice(), carriers: DEFAULT_CARRIERS.slice(), tools: DEFAULT_TOOLS.slice() };
  configData[key] = items;
  saveConfigToGitHub();
  renderAdminList();
  renderCards();
}

function addNewItem() { editItem(-1); }

function deleteItem(idx) {
  if (!confirm('Delete this item?')) return;
  var key = sectionKey(currentAdminTab);
  var items = getItems(key).slice();
  items.splice(idx, 1);
  if (!configData) configData = { apps: DEFAULT_APPS.slice(), carriers: DEFAULT_CARRIERS.slice(), tools: DEFAULT_TOOLS.slice() };
  configData[key] = items;
  saveConfigToGitHub();
  renderAdminList();
  renderCards();
}

function moveItem(idx, dir) {
  var key = sectionKey(currentAdminTab);
  var items = getItems(key).slice();
  var ni = idx + dir;
  if (ni < 0 || ni >= items.length) return;
  var tmp = items[idx]; items[idx] = items[ni]; items[ni] = tmp;
  if (!configData) configData = { apps: DEFAULT_APPS.slice(), carriers: DEFAULT_CARRIERS.slice(), tools: DEFAULT_TOOLS.slice() };
  configData[key] = items;
  saveConfigToGitHub();
  renderAdminList();
  renderCards();
}

// GitHub API save
async function saveConfigToGitHub() {
  var token = localStorage.getItem('gib_gh_token');
  if (!token) {
    token = prompt('Enter GitHub Personal Access Token (needed once to save changes):');
    if (!token) { alert('Cannot save without a GitHub token.'); return; }
    localStorage.setItem('gib_gh_token', token);
  }
  try {
    // Get current file SHA
    var getResp = await fetch('https://api.github.com/repos/' + GITHUB_REPO + '/contents/' + CONFIG_PATH, {
      headers: { 'Authorization': 'token ' + token }
    });
    var sha = '';
    if (getResp.ok) {
      var getData = await getResp.json();
      sha = getData.sha;
    }
    // Put updated config
    var content = btoa(unescape(encodeURIComponent(JSON.stringify(configData, null, 2))));
    var body = { message: 'Update portal config', content: content };
    if (sha) body.sha = sha;
    var putResp = await fetch('https://api.github.com/repos/' + GITHUB_REPO + '/contents/' + CONFIG_PATH, {
      method: 'PUT',
      headers: { 'Authorization': 'token ' + token, 'Content-Type': 'application/json' },
      body: JSON.stringify(body)
    });
    if (putResp.ok) {
      console.log('Config saved to GitHub');
    } else {
      var err = await putResp.json();
      console.error('GitHub save error:', err);
      if (putResp.status === 401) {
        localStorage.removeItem('gib_gh_token');
        alert('Invalid token. Please try again.');
      }
    }
  } catch(e) {
    console.error('Save error:', e);
  }
}

// Date
function setDate() {
  var d = new Date();
  var days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
  var months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
  var str = days[d.getDay()] + ', ' + months[d.getMonth()] + ' ' + d.getDate() + ', ' + d.getFullYear();
  document.getElementById('topDate').textContent = str;
  document.getElementById('footDate').textContent = str;
}

// MSAL Auth
var msalConfig = {
  auth: { clientId:'8418bc6f-da00-4cd7-936c-19665edac880', authority:'https://login.microsoftonline.com/8b20613e-54c4-43a3-af63-92cdbf260edb', redirectUri: window.location.origin + window.location.pathname },
  cache: { cacheLocation:'localStorage' }
};

async function showPortal(account) {
  var email = (account.username || account.userName || '').toLowerCase();
  var name = account.name || email.split('@')[0];
  currentUser = { name: name, email: email };
  console.log('User email:', email, 'Admin:', ADMIN_EMAILS.map(function(e){return e.toLowerCase()}).indexOf(email) !== -1);
  // Check admins from config or defaults
  var adminList = (configData && configData.admins) ? configData.admins : ADMIN_EMAILS;
  isAdmin = adminList.map(function(e){ return e.toLowerCase() }).indexOf(email) !== -1;

  var firstName = (name || '').split(' ')[0];
  var hour = new Date().getHours();
  var greetWord = hour < 12 ? 'Good morning' : hour < 17 ? 'Good afternoon' : 'Good evening';
  document.getElementById('greeting').innerHTML = greetWord + ', <span>' + firstName + '</span>';

  if (isAdmin) {
    document.getElementById('adminBtn').style.display = '';
    console.log('Admin access granted');
  }

  setDate();
  await loadConfig();
  renderCards();
  document.getElementById('authScreen').style.display = 'none';
  document.getElementById('portal').style.display = '';
}

async function initAuth() {
  try {
    msalApp = new msal.PublicClientApplication(msalConfig);
    await msalApp.initialize();
    var resp = await msalApp.handleRedirectPromise();
    if (resp) { showPortal(resp.account); return; }
    var accounts = msalApp.getAllAccounts();
    if (accounts.length > 0) {
      try {
        var sr = await msalApp.acquireTokenSilent({scopes:['user.read'],account:accounts[0]});
        showPortal(sr.account); return;
      } catch(e) { console.log('Silent token failed:', e); }
      try {
        var ss = await msalApp.ssoSilent({scopes:['user.read']});
        showPortal(ss.account); return;
      } catch(e) { console.log('SSO silent failed:', e); }
    }
    document.getElementById('authSpinner').style.display = 'none';
    document.getElementById('authStatus').textContent = 'Please sign in to continue';
    document.getElementById('authBtn').style.display = 'inline-block';
  } catch(e) {
    console.error('Auth init error:', e);
    document.getElementById('authSpinner').style.display = 'none';
    document.getElementById('authStatus').innerHTML = 'Authentication error: ' + e.message + '<br><small style="color:#999">Redirect URI: ' + msalConfig.auth.redirectUri + '</small>';
    document.getElementById('authBtn').style.display = 'inline-block';
  }
}

async function doLogin() {
  try {
    document.getElementById('authBtn').textContent = 'Signing in...';
    var r = await msalApp.loginPopup({scopes:['user.read']});
    showPortal(r.account);
  } catch(e) {
    console.error('Login error:', e);
    document.getElementById('authBtn').textContent = 'Sign in with Microsoft';
    document.getElementById('authStatus').innerHTML = 'Login failed: ' + e.message + '<br><small style="color:#999">Make sure popups are allowed and redirect URI matches in Azure.</small>';
  }
}

// Don't run auth inside popup windows
if (window.opener) {
  // We're inside a popup - let MSAL handle the redirect
  var popupMsal = new msal.PublicClientApplication(msalConfig);
  popupMsal.initialize().then(function() {
    popupMsal.handleRedirectPromise();
  });
} else {
  initAuth();
}
</script>
</body></html>
